<!DOCTYPE html>
<html lang="en">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  
    <title>If your SSH config feels unmanageable, it probably is. :: Oliver Reardon</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="How to organize and automate your SSH configuration using modular files and Ansible for better maintainability and portability." />
<meta name="keywords" content="ssh config, modular ssh, ansible, dotfiles, linux, automation" />

  <meta name="robots" content="noodp" />

<link rel="canonical" href="//localhost:1313/posts/if-your-ssh-config-feels-unmanageable-it-probably-is/" />





  
  <link rel="stylesheet" href="//localhost:1313/css/buttons.min.86f6b4c106b6c6eb690ae5203d36b442c1f66f718ff4e8164fa86cf6c61ad641.css">

  
  <link rel="stylesheet" href="//localhost:1313/css/code.min.4f0ccc8439f99bf7f7970298556b94011aabc1fcae743b6842fc3361a2da9ea3.css">

  
  <link rel="stylesheet" href="//localhost:1313/css/fonts.min.5bb7ed13e1d00d8ff39ea84af26737007eb5051b157b86fc24487c94f3dc8bbe.css">

  
  <link rel="stylesheet" href="//localhost:1313/css/footer.min.eb8dfc2c6a7eafa36cd3ba92d63e69e849e2200e0002a228d137f236b09ecd75.css">

  
  <link rel="stylesheet" href="//localhost:1313/css/gist.min.a751e8b0abe1ba8bc53ced52a38b19d8950fe78ca29454ea8c2595cf26aad5c0.css">

  
  <link rel="stylesheet" href="//localhost:1313/css/header.min.75c7eb0e2872d95ff48109c6647d0223a38db52e2561dd87966eb5fc7c6bdac6.css">

  
  <link rel="stylesheet" href="//localhost:1313/css/main.min.15870410d15d02abd22fb5ef00996f65a00d04b3a7435e9f83831c7c2298de88.css">

  
  <link rel="stylesheet" href="//localhost:1313/css/menu.min.3c17467ebeb3d38663dce68f71f519901124fa5cbb4519b2fb0667a21e9aca39.css">

  
  <link rel="stylesheet" href="//localhost:1313/css/pagination.min.bbb986dbce00a5ce5aca0504b7925fc1c581992a4bf57f163e5d69cc1db7d836.css">

  
  <link rel="stylesheet" href="//localhost:1313/css/post.min.e6dddd258e64c83e05cec0cd49c05216742d42fc8ecbfbe6b67083412b609bd3.css">

  
  <link rel="stylesheet" href="//localhost:1313/css/syntax.min.a0773cce9310cb6d8ed23e50f005448facf29a53001b57e038828daa466b25c0.css">

  
  <link rel="stylesheet" href="//localhost:1313/css/terminal.min.e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855.css">

  
  <link rel="stylesheet" href="//localhost:1313/css/terms.min.b81791663c3790e738e571cdbf802312390d30e4b1d8dc9d814a5b5454d0ac11.css">







<link rel="shortcut icon" href="//localhost:1313/favicon.png">
<link rel="apple-touch-icon" href="//localhost:1313/apple-touch-icon.png">


<meta name="twitter:card" content="summary" />

  
    <meta name="twitter:site" content="" />
  
    <meta name="twitter:creator" content="" />



<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="If your SSH config feels unmanageable, it probably is.">
<meta property="og:description" content="How to organize and automate your SSH configuration using modular files and Ansible for better maintainability and portability." />
<meta property="og:url" content="//localhost:1313/posts/if-your-ssh-config-feels-unmanageable-it-probably-is/" />
<meta property="og:site_name" content="Oliver Reardon" />

  
  
  <meta property="og:image" content="//localhost:1313/">

<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="627">


  <meta property="article:published_time" content="2025-04-23 15:43:00 -0400 EDT" />












</head>
<body>


<div class="container full">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/">
  <div class="logo">
    Oliver Reardon
  </div>
</a>

    </div>
    
      <ul class="menu menu--mobile">
  <li class="menu__trigger">Menu&nbsp;▾</li>
  <li>
    <ul class="menu__dropdown">
      
        
          <li><a href="/">Talent Profile</a></li>
        
      
        
          <li><a href="/posts">Posts</a></li>
        
      
        
          <li><a href="https://linkedin.com/in/oliver-reardon">LinkedIn</a></li>
        
      
        
          <li><a href="https://github.com/oliver-reardon">GitHub</a></li>
        
      
      
    </ul>
  </li>
</ul>

    
    
  </div>
  
    <nav class="navigation-menu">
  <ul class="navigation-menu__inner menu--desktop">
    
      
        
          <li><a href="/" >Talent Profile</a></li>
        
      
        
          <li><a href="/posts" >Posts</a></li>
        
      
      
        <li>
          <ul class="menu">
            <li class="menu__trigger">Show more&nbsp;▾</li>
            <li>
              <ul class="menu__dropdown">
                
                  
                    <li><a href="https://linkedin.com/in/oliver-reardon" >LinkedIn</a></li>
                  
                
                  
                    <li><a href="https://github.com/oliver-reardon" >GitHub</a></li>
                  
                
              </ul>
            </li>
          </ul>
        </li>
      
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
<article class="post">
  <h1 class="post-title">
    <a href="//localhost:1313/posts/if-your-ssh-config-feels-unmanageable-it-probably-is/">If your SSH config feels unmanageable, it probably is.</a>
  </h1>
  <div class="post-meta"><time class="post-date">2025-04-23</time><span class="post-author">Oliver Reardon</span><span class="post-reading-time">3 min read (460 words)</span></div>

  
    <span class="post-tags">
      
      #<a href="//localhost:1313/tags/ssh/">ssh</a>&nbsp;
      
      #<a href="//localhost:1313/tags/config/">config</a>&nbsp;
      
      #<a href="//localhost:1313/tags/ansible/">ansible</a>&nbsp;
      
      #<a href="//localhost:1313/tags/dotfiles/">dotfiles</a>&nbsp;
      
      #<a href="//localhost:1313/tags/automation/">automation</a>&nbsp;
      
    </span>
  
  


  

  <div class="post-content"><div>
        <h1 id="why-a-modular-ssh-config">Why a Modular SSH Config?<a href="#why-a-modular-ssh-config" class="hanchor" ariaLabel="Anchor">#</a> </h1>
<p>Managing SSH configuration can quickly become overwhelming as your environment grows. A single <code>~/.ssh/config</code> file often turns into a tangled mix of work servers, personal machines, cloud hosts, and GitHub setups. Over time, this file accumulates dozens—sometimes hundreds—of entries, making it difficult to find what you need, spot errors, or safely share parts of your config. One misplaced line or typo can break connectivity for multiple hosts, and the lack of structure makes it risky to reuse or sync your config across devices. By adopting a modular approach—splitting your SSH configuration into focused, numbered files grouped by context—you gain clarity, maintainability, and the flexibility to share or update only the relevant sections. This method transforms SSH management from a fragile, monolithic file into a robust, organized system that scales with your needs.</p>
<h2 id="directory-structure-example">Directory Structure Example<a href="#directory-structure-example" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">~/.ssh/config.d/
</span></span><span class="line"><span class="cl">├── 100_work/config
</span></span><span class="line"><span class="cl">├── 200_home/config
</span></span><span class="line"><span class="cl">├── 300_personal/config
</span></span><span class="line"><span class="cl">├── 400_github_work/config
</span></span><span class="line"><span class="cl">└── 500_github_home/config
</span></span></code></pre></div><h2 id="how-ordering-works">How Ordering Works<a href="#how-ordering-works" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<p>Each subfolder contains a focused config file, grouped by context and prefixed with a number to control load order. When you combine these files (often with a script or by using <code>Include</code> directives in your main <code>~/.ssh/config</code>), they are processed in lexicographical (alphabetical) order. By prefixing each folder with a number, you ensure that configs are loaded in a predictable sequence <code>100_...</code> first, then <code>200_...</code>, and so on.</p>
<h2 id="using-the-include-directive">Using the Include Directive<a href="#using-the-include-directive" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<blockquote>
<p>Note: SSH&rsquo;s Include directive is supported in OpenSSH 7.3 and later. Run <code>ssh -V</code> to confirm your version.</p></blockquote>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl"># ~/.ssh/config
</span></span><span class="line"><span class="cl">Include ~/.ssh/config.d/*/config
</span></span></code></pre></div><h2 id="benefits-of-this-setup">Benefits of This Setup<a href="#benefits-of-this-setup" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<p>This setup keeps everything modular, readable, and far easier to manage. It also makes syncing configs across devices—or sharing just the work-related parts—safe and straightforward. Once you try it, the old single-file approach feels instantly outdated.</p>
<p>Use <code>ssh -G &lt;host&gt;</code> to preview the final, merged configuration for a host—including settings from all included files—without actually connecting, making it ideal for debugging modular SSH setups.</p>
<h2 id="bootstrap-your-modular-ssh-setup-with-ansible">Bootstrap Your Modular SSH Setup with Ansible<a href="#bootstrap-your-modular-ssh-setup-with-ansible" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<p>The following Ansible playbook can automate the bootstrap of this modular SSH configuration. It clones a dotfiles repository, creates an SSH config file with an <code>Include</code> directive to load all configs from the <code>config.d</code> directory, and symlinks the grouped config directory into place. This keeps the SSH setup organized, maintainable, and easy to sync across systems.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nn">---</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Clone dotfiles repo</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">ansible.builtin.git</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">repo</span><span class="p">:</span><span class="w"> </span><span class="l">git@github.com:gituser/dotfiles.git</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">dest</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;{{ ansible_env.HOME }}/dotfiles&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">accept_hostkey</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">force</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Ensure ~/.ssh/config exists with Include directive</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">copy</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">dest</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;{{ ansible_env.HOME }}/.ssh/config&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">content</span><span class="p">:</span><span class="w"> </span><span class="p">|</span><span class="sd">
</span></span></span><span class="line"><span class="cl"><span class="sd">      # Auto-generated by Ansible: Include all configs from config.d directory
</span></span></span><span class="line"><span class="cl"><span class="sd">      Include {{ ansible_env.HOME }}/.ssh/config.d/*/config</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">owner</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;{{ ansible_env.USER }}&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;0644&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Create Symlinks</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">file</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">src</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;{{ ansible_env.HOME }}/dotfiles/{{ item.src }}&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">dest</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;{{ ansible_env.HOME }}/{{ item.dest }}&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l">link</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">force</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">loop</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- {<span class="w"> </span><span class="nt">src</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;ssh-config.d&#34;</span><span class="nt">, dest</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;.ssh/config.d&#34;</span><span class="w"> </span>}<span class="w">
</span></span></span></code></pre></div>
      </div></div>

  

  
    

  
</article>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>© 2025 Powered by <a href="https://gohugo.io">Hugo</a></span>
    
      <span>:: <a href="https://github.com/panr/hugo-theme-terminal" target="_blank">Theme</a> made by <a href="https://github.com/panr" target="_blank">panr</a></span>
      </div>
  </div>
</footer>






<script type="text/javascript" src="/bundle.min.js"></script>





  
</div>

</body>
</html>
